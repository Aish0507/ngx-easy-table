<div class="ngx-container">
  <div class="ngx-columns">
    <div class="ngx-column ngx-col-4 ngx-col-mr-auto"></div>
    <div class="ngx-column ngx-col-3">
      <global-search
        *ngIf="config.globalSearchEnabled"
        (globalUpdate)="globalSearchTerm = $event">
      </global-search>
    </div>
  </div>
  <div class="ngx-columns">
    <table class="ngx-table ngx-table-striped ngx-table-hover">
      <thead>
      <tr>
        <ng-container *ngFor="let key of headerKeys">
          <th *ngIf="showColumn(key)"
              (click)="orderBy(key)">
            <div class="ngx-d-inline">{{ key }}</div>
            <span *ngIf="resource.order[key]==='asc' "
                  [style.display]="config.orderEnabled?'':'none' "
                  class="ngx-icon ngx-icon-arrow-up">
        </span>
            <span *ngIf="resource.order[key]==='desc' "
                  [style.display]="config.orderEnabled?'':'none' "
                  class="ngx-icon ngx-icon-arrow-down">
        </span>
          </th>
        </ng-container>
        <th *ngIf="config.additionalActions">
          <div class="ngx-dropdown">
            <a class="ngx-btn ngx-btn-link ngx-dropdown-toggle" tabindex="0">
              <span class="ngx-icon ngx-icon-menu"></span>
            </a>
            <ul class="ngx-menu ngx-table__table-menu">
              <li class="ngx-menu-item">
                <csv-export *ngIf="config.exportEnabled"></csv-export>
              </li>
            </ul>
          </div>
        </th>
      </tr>
      <tr *ngIf="config.searchEnabled">
        <ng-container *ngFor="let key of resource.keys">
          <th *ngIf="showColumn(key)">
            <table-header (update)="term = $event" [key]="key"></table-header>
          </th>
        </ng-container>
        <th *ngIf="config.additionalActions"></th>
      </tr>
      </thead>
      <tbody *ngIf="data">
      <ng-container *ngIf="tpl">
        <tr *ngFor="let row of data | search : term | global : globalSearchTerm | pagination : range;
              let rowIndex = index"
            [class.ngx-table__table-row--selected]="rowIndex == selectedRow && !config.selectCell">
          <ng-container [ngTemplateOutlet]="tpl"
                        [ngOutletContext]="{ $implicit: row }">
          </ng-container>
        </tr>
      </ng-container>
      <ng-container *ngIf="!tpl">
        <tr *ngFor="let row of data | search : term | global : globalSearchTerm | pagination : range;
              let rowIndex = index"
            [class.ngx-table__table-row--selected]="rowIndex == selectedRow && !config.selectCell">
          <ng-container *ngFor="let key of resource.keys; let colIndex = index">
            <td *ngIf="showColumn(key)"
                (click)="clickedCell($event, row, key, colIndex, rowIndex)"
                [class.ngx-table__table-col--selected]="colIndex == selectedCol && !config.selectCell"
                [class.ngx-table__table-cell--selected]="colIndex == selectedCol && rowIndex == selectedRow && !config.selectCol && !config.selectRow"
            >
              <div>{{ row[key] }}</div>
            </td>
          </ng-container>
          <td *ngIf="config.additionalActions">
            <!--<button class="ngx-table__button">Edit</button>-->
          </td>
        </tr>
      </ng-container>
      </tbody>
      <tbody *ngIf="!data">
      <tr>
        <td>No results</td>
      </tr>
      </tbody>
      <tfoot *ngIf="config.footerEnabled">
      <tr>
        <td *ngFor="let key of resource.keys"></td>
        <td></td>
      </tr>
      </tfoot>
    </table>
  </div>
  <pagination
    *ngIf="config.paginationEnabled"
    [numberOfItems]="numberOfItems"
    (updateRange)="range = $event">
  </pagination>
</div>
